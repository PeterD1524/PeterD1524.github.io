<html>

<head>
  <title></title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:400,700|Noto+Sans+TC:400,700|Roboto+Mono:400,700|Material+Icons">
  <!--Load the AJAX API-->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {

      // Load the Visualization API and the corechart package.
      google.charts.load('current', { 'packages': ['corechart'] });

      function resolveAfter(ms) {
        return new Promise(resolve => {
          setTimeout(resolve, ms);
        });
      }

      function storageAvailable(type) {
        let storage;
        try {
          storage = window[type];
          let x = '__storage_test__';
          storage.setItem(x, x);
          storage.removeItem(x);
          return true;
        }
        catch (e) {
          return e instanceof DOMException && (
            // everything except Firefox
            e.code === 22 ||
            // Firefox
            e.code === 1014 ||
            // test name field too, because code might not be present
            // everything except Firefox
            e.name === 'QuotaExceededError' ||
            // Firefox
            e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&
            // acknowledge QuotaExceededError only if there's something already stored
            (storage && storage.length !== 0);
        }
      }

      let languageOptions = ['English', 'Italiano', 'Français', 'Deutsch', 'Español', '中文（繁體）', '한국어', '日本語'];
      let languages = ['en-us', 'it', 'fr', 'de', 'es', 'zh-tw', 'ko', 'ja'];

      let body = document.querySelector('body');
      let title = document.querySelector('head > title');


      let params = (new URL(document.location)).searchParams;

      let language;


      if (params.has('language')) {
        if (languages.indexOf(params.get('language')) !== -1) {
          language = params.get('language');
        }
      } else {
        if (storageAvailable('localStorage')) {
          if (localStorage.getItem('language') === null) {
            let subtags = ['en', 'it', 'fr', 'de', 'es', 'zh', 'ko', 'ja'];
            for (let i = 0; i < subtags.length; i++) {
              if (navigator.language.startsWith(subtags[i])) {
                language = languages[i];
                params.set('language', language);
                window.location = (new URL(document.location)).toString().split('?')[0] + '?' + params.toString();
              }
            }
          } else {
            // let cookieLanguageValue = document.cookie.replace(/(?:(?:^|.*;\s*)language\s*\=\s*([^;]*).*$)|^.*$/, "$1");
            if (languages.indexOf(localStorage.getItem('language')) !== -1) {
              language = localStorage.getItem('language');
            } else {
            }
          }
        } else {
        }
      }

      let div = document.createElement('div');
      body.appendChild(div);
      let select = document.createElement('select');
      div.appendChild(select);
      select.addEventListener("change", languagechangeHandler);
      for (let i = 0; i < languageOptions.length; i++) {
        let option = document.createElement('option');
        select.appendChild(option);
        option.textContent = languageOptions[i];
        option.value = languages[i];
      }
      if (language !== undefined) {
        select.value = language;
      }

      let Untitled_spreadsheet = {
        URL: 'https://docs.google.com/spreadsheets/d/18Gjj4A1KX_tZMzeM7jDsd4g-DvE7b2CWF1rWqoh5NPs',
        sheets: {
          gen_WazaGetDesc: {
            headers: '0',
            gid: '434807980',
            sheet: 'gen_WazaGetDesc',
            range: 'A:ABQ',
          },
          gen_WazaDesc: {
            headers: '0',
            gid: '1224240823',
            sheet: 'gen_WazaDesc',
            range: 'A:BJ',
          },
          gen_PiiDesc: {
            headers: '0',
            gid: '181327591',
            sheet: 'gen_PiiDesc',
            range: 'A:BH',
          },
          'gen_WazaDesc m_name': {
            headers: '0',
            gid: '1155071408',
            sheet: 'gen_WazaDesc m_name',
            range: 'A:I',
          },
          Pokémon: {
            headers: '0',
            gid: '1618710016',
            sheet: 'Pokémon',
            range: 'A:K',
          }
        },
      };

      let callback = {
        gen_WazaDesc: function (ID) {
          if (ID === undefined) {
            let dataSourceUrl, optional_parameters;
            let queryString;
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaDesc[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'range' + '=' + 'A:B' + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            if (language !== undefined) {
              queryString = encodeURIComponent('select A, ' + ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'][languages.indexOf(language)]);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['gen_WazaDesc m_name'][optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            }
            let query;
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let gen_WazaDesc = QueryResponse.getDataTable();
              let table = document.createElement('table');
              body.appendChild(table);
              let tr;

              let thead = document.createElement('thead');
              table.appendChild(thead);
              tr = document.createElement('tr');
              thead.appendChild(tr);
              for (let i = 0; i < gen_WazaDesc.getNumberOfColumns(); i++) {
                let th = document.createElement('th');
                tr.appendChild(th);
                th.textContent = gen_WazaDesc.getColumnLabel(i);
              }

              let tbody = document.createElement('tbody');
              table.appendChild(tbody);
              for (let i = 0; i < gen_WazaDesc.getNumberOfRows(); i++) {
                tr = document.createElement('tr');
                tbody.appendChild(tr);
                for (let j = 0; j < gen_WazaDesc.getNumberOfColumns(); j++) {
                  let td = document.createElement('td');
                  tr.appendChild(td);
                  let a = document.createElement('a');
                  td.appendChild(a);
                  a.setAttribute('href', (new URL(document.location)) + '&' + 'ID' + '=' + gen_WazaDesc.getValue(i, 0));
                  a.textContent = gen_WazaDesc.getValue(i, j);
                }
              }
            });
          } else {
            let dataSourceUrl, optional_parameters;
            let queryString;
            queryString = encodeURIComponent('where A = ' + ID);
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaDesc[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            let query;
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let gen_WazaDesc = QueryResponse.getDataTable();
              let table = document.createElement('table');
              body.appendChild(table);
              let tr;
              let tbody = document.createElement('tbody');
              table.appendChild(tbody);
              for (let i = 0; i < gen_WazaDesc.getNumberOfColumns(); i++) {
                tr = document.createElement('tr');
                tbody.appendChild(tr);
                let td;
                td = document.createElement('td');
                tr.appendChild(td);
                let label = gen_WazaDesc.getColumnLabel(i);
                td.textContent = label;
                for (let j = 0; j < gen_WazaDesc.getNumberOfRows(); j++) {
                  td = document.createElement('td');
                  tr.appendChild(td);
                  td.textContent = gen_WazaDesc.getValue(j, i);
                  if (label === 'm_name') {
                    queryString = encodeURIComponent('select ' + ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'][languages.indexOf(language)] + ' where A = ' + ID);
                    dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
                    optional_parameters = ['gid'];
                    for (let i = 0; i < optional_parameters.length; i++) {
                      dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['gen_WazaDesc m_name'][optional_parameters[i]] + '&';
                    }
                    dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
                    if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
                    query = new google.visualization.Query(dataSourceUrl);
                    query.send(function (QueryResponse) {
                      let gen_WazaDescm_name = QueryResponse.getDataTable();
                      if (gen_WazaDescm_name.getNumberOfRows() === 1 && gen_WazaDescm_name.getNumberOfColumns() === 1) {
                        td.textContent = gen_WazaDescm_name.getValue(0, 0);
                      }
                    });
                  }
                }
              }
            });
          }
        },
        gen_PiiDesc: function (m_Monsno, m_Formno) {
          if (m_Monsno === undefined) {
            let dataSourceUrl, optional_parameters;
            let queryString;
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'range' + '=' + 'A:D' + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            if (language !== undefined) {
              queryString = encodeURIComponent('select A, B, C, ' + ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K'][languages.indexOf(language)]);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            }
            let query;
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let Pokémon = QueryResponse.getDataTable();
              let table = document.createElement('table');
              body.appendChild(table);
              let tr;

              let thead = document.createElement('thead');
              table.appendChild(thead);
              tr = document.createElement('tr');
              thead.appendChild(tr);
              for (let i = 0; i < Pokémon.getNumberOfColumns(); i++) {
                let th = document.createElement('th');
                tr.appendChild(th);
                th.textContent = Pokémon.getColumnLabel(i);
                if (i === 3) {
                  th.textContent = 'Pokémon';
                }
              }

              let tbody = document.createElement('tbody');
              table.appendChild(tbody);
              for (let i = 0; i < Pokémon.getNumberOfRows(); i++) {
                tr = document.createElement('tr');
                tbody.appendChild(tr);
                for (let j = 0; j < Pokémon.getNumberOfColumns(); j++) {
                  let td = document.createElement('td');
                  tr.appendChild(td);
                  if (j === 0 || j === 3) {
                    let a = document.createElement('a');
                    td.appendChild(a);
                    a.setAttribute('href', (new URL(document.location)) + '&' + 'm_Monsno' + '=' + Pokémon.getValue(i, 1) + '&' + 'm_Formno' + '=' + Pokémon.getValue(i, 2));
                    a.textContent = Pokémon.getValue(i, j);
                    if (j === 3) {
                      let img = document.createElement('img');
                      a.prepend(img);
                      img.src = 'https://cdn.discordapp.com/emojis/402867992930680833.png';
                      img.style.width = '1em';
                      img.style.verticalAlign = 'middle';
                    }
                  } else {
                    td.textContent = Pokémon.getValue(i, j);
                  }
                }
              }
            });
          } else {
            if (m_Formno === undefined) {

            } else {
              let dataSourceUrl, optional_parameters;
              let queryString;
              let query;
              let div;
              div = document.createElement('div');
              body.appendChild(div);
              queryString = encodeURIComponent('select ' + ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K'][languages.indexOf(language)] + ' where B = ' + m_Monsno + ' and C = ' + m_Formno);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                let Pokémon = QueryResponse.getDataTable();
                if (Pokémon.getNumberOfRows() === 1 && Pokémon.getNumberOfColumns() === 1) {
                  let img = document.createElement('img');
                  div.textContent = Pokémon.getValue(0, 0);
                  div.prepend(img);
                  img.src = 'https://cdn.discordapp.com/emojis/402867992930680833.png';
                  img.style.width = '1em';
                  img.style.verticalAlign = 'middle';
                }
              });

              queryString = encodeURIComponent('where B = ' + m_Monsno + ' and C = ' + m_Formno);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_PiiDesc[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                let gen_PiiDesc = QueryResponse.getDataTable();
                let table = document.createElement('table');
                body.appendChild(table);
                let tr;
                let tbody = document.createElement('tbody');
                table.appendChild(tbody);
                for (let i = 0; i < gen_PiiDesc.getNumberOfColumns(); i++) {
                  tr = document.createElement('tr');
                  tbody.appendChild(tr);
                  let td;
                  td = document.createElement('td');
                  tr.appendChild(td);
                  let label = gen_PiiDesc.getColumnLabel(i);
                  td.textContent = label;
                  for (let j = 0; j < gen_PiiDesc.getNumberOfRows(); j++) {
                    td = document.createElement('td');
                    tr.appendChild(td);
                    td.textContent = gen_PiiDesc.getValue(j, i);
                  }
                }
              });
            }
          }
        },

      }

      if (params.has('query')) {
        let q = params.get('query');
        let cb;
        if (q === 'gen_PiiDesc') {
          title.textContent = 'gen_WazaDesc';
          if (params.has('m_Monsno')) {
            let m_Monsno = params.get('m_Monsno');
            if (params.has('m_Formno')) {
              let m_Formno = params.get('m_Formno');
              cb = function () {
                callback.gen_PiiDesc(m_Monsno, m_Formno);
              };
            } else {
              cb = function () {
                callback.gen_PiiDesc(m_Monsno);
              };
            }
          } else {
            cb = callback.gen_PiiDesc;
          }
        } else if (q === 'gen_WazaDesc') {
          title.textContent = 'gen_WazaDesc';
          if (params.has('ID')) {
            let ID = params.get('ID');
            cb = function () {
              callback.gen_WazaDesc(ID);
            };
          } else {
            cb = callback.gen_WazaDesc;
          }
        }
        google.charts.setOnLoadCallback(cb);
      } else {
        let div = document.createElement('div');
        body.appendChild(div);
        let a;
        a = document.createElement('a');
        div.appendChild(a);
        a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + 'query' + '=' + 'gen_PiiDesc');
        a.textContent = 'gen_PiiDesc';
        div.append(' ');
        a = document.createElement('a');
        div.appendChild(a);
        a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + 'query' + '=' + 'gen_WazaDesc');
        a.textContent = 'gen_WazaDesc';
      }

      function languagechangeHandler(event) {
        // document.cookie = "language=" + whatLanguage;
        if (storageAvailable('localStorage')) {
          localStorage.setItem('language', event.target.value);
        }
        params.set('language', event.target.value);
        select.value = language;
        window.location = (new URL(document.location)).toString().split('?')[0] + '?' + params.toString();
      }
    });
  </script>
  <style>
    body * {
      font-family: 'Roboto Mono', 'Roboto', 'Noto Sans TC', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
    }

    table {
      border-collapse: collapse;
    }

    th,
    td {
      border: 1px solid black;
    }

    /* Rules for sizing the icon. */
    .material-icons.md-18 {
      font-size: 18px;
    }

    .material-icons.md-24 {
      font-size: 24px;
    }

    .material-icons.md-36 {
      font-size: 36px;
    }

    .material-icons.md-48 {
      font-size: 48px;
    }

    /* Rules for using icons as black on a light background. */
    .material-icons.md-dark {
      color: rgba(0, 0, 0, 0.54);
    }

    .material-icons.md-dark.md-inactive {
      color: rgba(0, 0, 0, 0.26);
    }
  </style>
</head>

<body>
</body>

</html>