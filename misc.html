<html>

<head>
  <title></title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:400,700|Noto+Sans+TC:400,700|Roboto+Mono:400,700|Material+Icons">
  <!--Load the AJAX API-->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {

      // Load the Visualization API and the corechart package.
      google.charts.load('current', { 'packages': ['corechart'] });

      function resolveAfter(ms) {
        return new Promise(resolve => {
          setTimeout(resolve, ms);
        });
      }

      function storageAvailable(type) {
        let storage;
        try {
          storage = window[type];
          let x = '__storage_test__';
          storage.setItem(x, x);
          storage.removeItem(x);
          return true;
        }
        catch (e) {
          return e instanceof DOMException && (
            // everything except Firefox
            e.code === 22 ||
            // Firefox
            e.code === 1014 ||
            // test name field too, because code might not be present
            // everything except Firefox
            e.name === 'QuotaExceededError' ||
            // Firefox
            e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&
            // acknowledge QuotaExceededError only if there's something already stored
            (storage && storage.length !== 0);
        }
      }

      let languageOptions = ['English', 'Italiano', 'Français', 'Deutsch', 'Español', '中文（繁體）', '한국어', '日本語'];
      let languages = ['en-us', 'it', 'fr', 'de', 'es', 'zh-tw', 'ko', 'ja'];

      let body = document.querySelector('body');
      let title = document.querySelector('head > title');


      let params = (new URL(document.location)).searchParams;

      let language;


      if (params.has('language')) {
        if (languages.indexOf(params.get('language')) !== -1) {
          language = params.get('language');
        }
      } else {
        if (storageAvailable('localStorage')) {
          if (localStorage.getItem('language') === null) {
            let subtags = ['en', 'it', 'fr', 'de', 'es', 'zh', 'ko', 'ja'];
            for (let i = 0; i < subtags.length; i++) {
              if (navigator.language.startsWith(subtags[i])) {
                language = languages[i];
                params.set('language', language);
                window.location = (new URL(document.location)).toString().split('?')[0] + '?' + params.toString();
              }
            }
          } else {
            // let cookieLanguageValue = document.cookie.replace(/(?:(?:^|.*;\s*)language\s*\=\s*([^;]*).*$)|^.*$/, "$1");
            if (languages.indexOf(localStorage.getItem('language')) !== -1) {
              language = localStorage.getItem('language');
            } else {
            }
          }
        } else {
        }
      }

      let div = document.createElement('div');
      body.appendChild(div);
      let select = document.createElement('select');
      div.appendChild(select);
      select.addEventListener("change", languagechangeHandler);
      for (let i = 0; i < languageOptions.length; i++) {
        let option = document.createElement('option');
        select.appendChild(option);
        option.textContent = languageOptions[i];
        option.value = languages[i];
      }
      if (language !== undefined) {
        select.value = language;
      }

      let Untitled_spreadsheet = {
        URL: 'https://docs.google.com/spreadsheets/d/18Gjj4A1KX_tZMzeM7jDsd4g-DvE7b2CWF1rWqoh5NPs',
        sheets: {
          gen_WazaGetDesc: {
            headers: '0',
            gid: '825688940',
            sheet: 'gen_WazaGetDesc',
            range: 'A:ABQ',
          },
          gen_WazaDesc: {
            headers: '0',
            gid: '1224240823',
            sheet: 'gen_WazaDesc',
            range: 'A:BJ',
          },
          gen_PiiDesc: {
            headers: '0',
            gid: '181327591',
            sheet: 'gen_PiiDesc',
            range: 'A:BH',
          },
          'gen_WazaDesc m_name': {
            headers: '0',
            gid: '1155071408',
            sheet: 'gen_WazaDesc m_name',
            range: 'A:I',
          },
          Pokémon: {
            headers: '0',
            gid: '1618710016',
            sheet: 'Pokémon',
            range: 'A:K',
          },
          'PokeWazaTypeDesc.msbt': {
            headers: '0',
            gid: '198197519',
            sheet: 'PokeWazaTypeDesc.msbt',
            range: 'A:M',
          },
        },
      };

      let callback = {
        gen_WazaDesc: function (ID) {
          if (ID === undefined) {
            let dataSourceUrl, optional_parameters;
            let queryString;
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaDesc[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'range' + '=' + 'A:B' + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            if (language !== undefined) {
              queryString = encodeURIComponent('select A, ' + ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'][languages.indexOf(language)]);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['gen_WazaDesc m_name'][optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            }
            let query;
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let gen_WazaDesc = QueryResponse.getDataTable();
              let table = document.createElement('table');
              body.appendChild(table);
              let tr;

              let thead = document.createElement('thead');
              table.appendChild(thead);
              tr = document.createElement('tr');
              thead.appendChild(tr);
              for (let i = 0; i < gen_WazaDesc.getNumberOfColumns(); i++) {
                let th = document.createElement('th');
                tr.appendChild(th);
                th.textContent = gen_WazaDesc.getColumnLabel(i);
              }

              let tbody = document.createElement('tbody');
              table.appendChild(tbody);
              for (let i = 0; i < gen_WazaDesc.getNumberOfRows(); i++) {
                tr = document.createElement('tr');
                tbody.appendChild(tr);
                for (let j = 0; j < gen_WazaDesc.getNumberOfColumns(); j++) {
                  let td = document.createElement('td');
                  tr.appendChild(td);
                  let a = document.createElement('a');
                  td.appendChild(a);
                  a.setAttribute('href', (new URL(document.location)) + '&' + 'ID' + '=' + gen_WazaDesc.getValue(i, 0));
                  a.textContent = gen_WazaDesc.getValue(i, j);
                }
              }
            });
          } else {
            let dataSourceUrl, optional_parameters;
            let queryString;
            queryString = encodeURIComponent('where A = ' + ID);
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaDesc[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);



            let divs = [];
            for (let i = 0; i < 2; i++) {
              let div = document.createElement('div');
              body.appendChild(div);
              divs.push(div);
            }


            let query;
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let gen_WazaDesc = QueryResponse.getDataTable();
              let table = document.createElement('table');
              divs[0].appendChild(table);
              let tr;
              let tbody = document.createElement('tbody');
              table.appendChild(tbody);
              for (let i = 0; i < gen_WazaDesc.getNumberOfColumns(); i++) {
                tr = document.createElement('tr');
                tbody.appendChild(tr);
                let td;
                td = document.createElement('td');
                tr.appendChild(td);
                let label = gen_WazaDesc.getColumnLabel(i);
                td.textContent = label;
                for (let j = 0; j < gen_WazaDesc.getNumberOfRows(); j++) {
                  td = document.createElement('td');
                  tr.appendChild(td);
                  td.textContent = gen_WazaDesc.getValue(j, i);
                  if (label === 'm_name') {
                    queryString = encodeURIComponent('select ' + ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'][languages.indexOf(language)] + ' where A = ' + ID);
                    dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
                    optional_parameters = ['gid'];
                    for (let i = 0; i < optional_parameters.length; i++) {
                      dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['gen_WazaDesc m_name'][optional_parameters[i]] + '&';
                    }
                    dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
                    if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
                    query = new google.visualization.Query(dataSourceUrl);
                    query.send(function (QueryResponse) {
                      let gen_WazaDescm_name = QueryResponse.getDataTable();
                      if (gen_WazaDescm_name.getNumberOfRows() === 1 && gen_WazaDescm_name.getNumberOfColumns() === 1) {
                        td.textContent = gen_WazaDescm_name.getValue(0, 0);
                      }
                    });
                  }
                }
              }
            });
            let n = Number(ID) + 4;
            let column = '';
            while (n > 0) {
              column = String.fromCharCode('A'.charCodeAt(0) + (n - 1) % 26) + column;
              n = (n - (n - 1) % 26 - 1) / 26;
            }

            queryString = encodeURIComponent('select B, C, ' + column);
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaGetDesc[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let gen_WazaGetDesc = QueryResponse.getDataTable();
              let div = document.createElement('div');
              divs[1].appendChild(div);
              div.textContent = 'Learnset';
              let table = document.createElement('table');
              divs[1].appendChild(table);
              let tr;

              let thead = document.createElement('thead');
              table.appendChild(thead);
              tr = document.createElement('tr');
              thead.appendChild(tr);
              for (let i = 0; i < 2; i++) {
                let th = document.createElement('th');
                tr.appendChild(th);
                th.textContent = gen_WazaGetDesc.getColumnLabel(i);
              }
              let th;
              th = document.createElement('th');
              tr.appendChild(th);
              th.textContent = 'Pokémon';
              th = document.createElement('th');
              tr.appendChild(th);
              th.textContent = gen_WazaGetDesc.getColumnLabel(2);

              let tbody = document.createElement('tbody');
              table.appendChild(tbody);

              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'range' + '=' + 'A:D' + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              if (language !== undefined) {
                queryString = encodeURIComponent('select A, B, C, ' + ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K'][languages.indexOf(language)]);
                dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
                optional_parameters = ['gid'];
                for (let i = 0; i < optional_parameters.length; i++) {
                  dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
                }
                dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
                if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              }
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                let Pokémon = QueryResponse.getDataTable();
                let nothing = true;
                for (let i = 0; i < gen_WazaGetDesc.getNumberOfRows(); i++) {
                  if (gen_WazaGetDesc.getValue(i, 2) > 0) {
                    nothing = false;
                    tr = document.createElement('tr');
                    tbody.appendChild(tr);
                    let m_Monsno = gen_WazaGetDesc.getValue(i, 0), m_Formno = gen_WazaGetDesc.getValue(i, 1);
                    for (let j = 0; j < 2; j++) {
                      let td = document.createElement('td');
                      tr.appendChild(td);
                      td.textContent = gen_WazaGetDesc.getValue(i, j);
                    }
                    let td;
                    td = document.createElement('td');
                    tr.appendChild(td);
                    let a;
                    a = document.createElement('a');
                    td.appendChild(a);
                    let tempParams = (new URL(document.location)).searchParams;
                    tempParams.set('query', 'gen_PiiDesc');
                    tempParams.set('m_Monsno', m_Monsno);
                    tempParams.set('m_Formno', m_Formno);
                    tempParams.delete('ID');
                    a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + tempParams.toString());
                    for (let j = 0; j < Pokémon.getNumberOfRows(); j++) {
                      if (Pokémon.getValue(j, 1) === m_Monsno && Pokémon.getValue(j, 2) === m_Formno) {
                        let img = document.createElement('img');
                        let span = document.createElement('span');
                        a.appendChild(span);
                        span.textContent = Pokémon.getValue(j, 3);
                        span.style.verticalAlign = 'middle';
                        a.prepend(img);
                        let UMF = ['U', 'M', 'F'], index = 0;
                        img.onerror = function () {
                          index = index + 1;
                          if (index < 3) {
                            img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/icon/' + m_Monsno.toString().padStart(3, '0') + '_' + UMF[index] + '_' + m_Formno.toString().padStart(2, '0') + '.png';
                          } else {
                            img.onerror = '';
                            img.src = 'https://cdn.discordapp.com/emojis/402867992930680833.png';
                          }
                        }
                        img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/icon/' + m_Monsno.toString().padStart(3, '0') + '_' + UMF[index] + '_' + m_Formno.toString().padStart(2, '0') + '.png';
                        img.style.height = '1em';
                        img.style.verticalAlign = 'middle';
                      }
                    }
                    td = document.createElement('td');
                    tr.appendChild(td);
                    td.textContent = gen_WazaGetDesc.getValue(i, 2);
                  }
                }

                if (nothing === true) {
                  tr = document.createElement('tr');
                  tbody.appendChild(tr);
                  let td = document.createElement('td');
                  tr.appendChild(td);
                  td.setAttribute('colspan', 4);
                  td.textContent = 'No information available.';
                }
              });
            });
          }
        },
        gen_PiiDesc: function (m_Monsno, m_Formno, ID) {
          if (m_Monsno === undefined) {
            let dataSourceUrl, optional_parameters;
            let queryString;
            dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
            optional_parameters = ['gid'];
            for (let i = 0; i < optional_parameters.length; i++) {
              dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
            }
            dataSourceUrl = dataSourceUrl + 'range' + '=' + 'A:D' + '&';
            if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            if (language !== undefined) {
              queryString = encodeURIComponent('select A, B, C, ' + ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K'][languages.indexOf(language)]);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
            }
            let query;
            query = new google.visualization.Query(dataSourceUrl);
            query.send(function (QueryResponse) {
              let Pokémon = QueryResponse.getDataTable();
              let table = document.createElement('table');
              body.appendChild(table);
              let tr;

              let thead = document.createElement('thead');
              table.appendChild(thead);
              tr = document.createElement('tr');
              thead.appendChild(tr);
              for (let i = 0; i < Pokémon.getNumberOfColumns(); i++) {
                let th = document.createElement('th');
                tr.appendChild(th);
                th.textContent = Pokémon.getColumnLabel(i);
                if (i === 3) {
                  th.textContent = 'Pokémon';
                }
              }

              let tbody = document.createElement('tbody');
              table.appendChild(tbody);
              for (let i = 0; i < Pokémon.getNumberOfRows(); i++) {
                tr = document.createElement('tr');
                tbody.appendChild(tr);
                for (let j = 0; j < Pokémon.getNumberOfColumns(); j++) {
                  let td = document.createElement('td');
                  tr.appendChild(td);
                  if (j === 0 || j === 3) {
                    let a = document.createElement('a');
                    td.appendChild(a);
                    a.setAttribute('href', (new URL(document.location)) + '&' + 'm_Monsno' + '=' + Pokémon.getValue(i, 1) + '&' + 'm_Formno' + '=' + Pokémon.getValue(i, 2));
                    if (j === 3) {
                      let img = document.createElement('img');
                      let span = document.createElement('span');
                      a.appendChild(span);
                      span.textContent = Pokémon.getValue(i, j);
                      span.style.verticalAlign = 'middle';
                      a.prepend(img);
                      let UMF = ['U', 'M', 'F'], index = 0;
                      img.onerror = function () {
                        index = index + 1;
                        if (index < 3) {
                          img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/icon/' + Pokémon.getValue(i, 1).toString().padStart(3, '0') + '_' + UMF[index] + '_' + Pokémon.getValue(i, 2).toString().padStart(2, '0') + '.png';
                        } else {
                          img.onerror = '';
                          img.src = 'https://cdn.discordapp.com/emojis/402867992930680833.png';
                        }
                      }
                      img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/icon/' + Pokémon.getValue(i, 1).toString().padStart(3, '0') + '_' + UMF[index] + '_' + Pokémon.getValue(i, 2).toString().padStart(2, '0') + '.png';
                      img.style.height = '1em';
                      img.style.verticalAlign = 'middle';
                    } else {
                      a.textContent = Pokémon.getValue(i, j);
                    }
                  } else {
                    td.textContent = Pokémon.getValue(i, j);
                  }
                }
              }
            });
          } else {
            if (m_Formno === undefined) {

            } else {
              let dataSourceUrl, optional_parameters;
              let queryString;
              let query;

              let gen_WazaDesc, PokeWazaTypeDescmsbt, gen_WazaDescm_name;

              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaDesc[optional_parameters[i]] + '&';
              }
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                gen_WazaDesc = QueryResponse.getDataTable();
              });

              queryString = encodeURIComponent('select A, ' + ['F', 'G', 'H', 'I', 'J', 'K', 'L', 'M'][languages.indexOf(language)]);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['PokeWazaTypeDesc.msbt'][optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                PokeWazaTypeDescmsbt = QueryResponse.getDataTable();
              });

              queryString = encodeURIComponent('select A, ' + ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'][languages.indexOf(language)]);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['gen_WazaDesc m_name'][optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                gen_WazaDescm_name = QueryResponse.getDataTable();
              });

              let divs = [];
              for (let i = 0; i < 4; i++) {
                let div = document.createElement('div');
                divs.push(div);
                body.appendChild(div);
              }

              queryString = encodeURIComponent('select ' + ['D', 'E', 'F', 'G', 'H', 'I', 'J', 'K'][languages.indexOf(language)] + ' where B = ' + m_Monsno + ' and C = ' + m_Formno);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.Pokémon[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                let Pokémon = QueryResponse.getDataTable();
                if (Pokémon.getNumberOfRows() === 1 && Pokémon.getNumberOfColumns() === 1) {
                  let img = document.createElement('img');
                  let span = document.createElement('span');
                  divs[0].appendChild(span);
                  span.textContent = Pokémon.getValue(0, 0);
                  span.style.verticalAlign = 'middle';
                  divs[0].prepend(img);
                  let UMF = ['U', 'M', 'F'], index = 0;
                  img.onerror = function () {
                    index = index + 1;
                    if (index < 3) {
                      img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/icon/' + m_Monsno.toString().padStart(3, '0') + '_' + UMF[index] + '_' + m_Formno.toString().padStart(2, '0') + '.png';
                    } else {
                      img.onerror = '';
                      img.src = 'https://cdn.discordapp.com/emojis/402867992930680833.png';
                    }
                  }
                  img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/icon/' + m_Monsno.toString().padStart(3, '0') + '_' + UMF[index] + '_' + m_Formno.toString().padStart(2, '0') + '.png';
                  img.style.height = '1em';
                  img.style.verticalAlign = 'middle';
                }
              });


              let img = document.createElement('img');
              divs[1].appendChild(img);
              divs[1].style.width = '200px';
              divs[1].style.height = '200px';
              divs[1].style.textAlign = 'center';
              divs[1].style.padding = '1em';

              let UMF = ['U', 'M', 'F'], index = 0;
              img.onerror = function () {
                index = index + 1;
                if (index < 3) {
                  img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/Texture2D/pii-icons-full/' + m_Monsno.toString().padStart(3, '0') + '_' + UMF[index] + '_' + m_Formno.toString().padStart(2, '0') + '.png';
                } else {
                  img.onerror = '';
                  img.src = 'https://cdn.discordapp.com/emojis/402867992930680833.png';
                }
              }
              img.src = 'https://raw.githubusercontent.com/PeterD1524/test/master/Texture2D/pii-icons-full/' + m_Monsno.toString().padStart(3, '0') + '_' + UMF[index] + '_' + m_Formno.toString().padStart(2, '0') + '.png';

              img.onload = function () {

                /*
                console.log(img.style.width);
                console.log(img.style.height);
                console.log(img.width);
                console.log(img.height);
                console.log(divs[1].style.width, divs[1].style.height, divs[1].width, divs[1].height);
                */

                if (img.width >= img.height) {
                  img.style.maxWidth = '100%';
                } else {
                  img.style.maxHeight = '100%';
                }
                img.style.marginTop = ((Number(divs[1].style.height.split('px')[0]) - img.height) / 2).toString() + 'px';
              };

              queryString = encodeURIComponent('where B = ' + m_Monsno + ' and C = ' + m_Formno);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_PiiDesc[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                let gen_PiiDesc = QueryResponse.getDataTable();
                let table = document.createElement('table');
                divs[2].appendChild(table);
                let tr;
                let tbody = document.createElement('tbody');
                table.appendChild(tbody);
                for (let i = 0; i < gen_PiiDesc.getNumberOfColumns(); i++) {
                  tr = document.createElement('tr');
                  tbody.appendChild(tr);
                  let td;
                  td = document.createElement('td');
                  tr.appendChild(td);
                  let label = gen_PiiDesc.getColumnLabel(i);
                  td.textContent = label;
                  for (let j = 0; j < gen_PiiDesc.getNumberOfRows(); j++) {
                    td = document.createElement('td');
                    tr.appendChild(td);
                    if (label === 'm_beforeEvoMonsNo') {
                      let a = document.createElement('a');
                      td.appendChild(a);
                      let tempParams = (new URL(document.location)).searchParams;;
                      tempParams.set('m_Monsno', gen_PiiDesc.getValue(j, i));
                      tempParams.delete('m_Formno');
                      a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + tempParams.toString());
                      a.textContent = gen_PiiDesc.getValue(j, i);
                    } else if (label === 'm_zakoWaza' || label === 'm_rivalWaza' || label === 'm_bossWaza' || label === 'm_bossWaza2') {
                      let a = document.createElement('a');
                      td.appendChild(a);
                      let tempParams = (new URL(document.location)).searchParams;;
                      tempParams.set('query', 'gen_WazaDesc');
                      tempParams.set('ID', gen_PiiDesc.getValue(j, i));
                      tempParams.delete('m_Monsno');
                      tempParams.delete('m_Formno');
                      a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + tempParams.toString());
                      a.textContent = gen_PiiDesc.getValue(j, i);

                      queryString = encodeURIComponent('select ' + ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'][languages.indexOf(language)] + ' where A = ' + gen_PiiDesc.getValue(j, i));
                      dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
                      optional_parameters = ['gid'];
                      for (let i = 0; i < optional_parameters.length; i++) {
                        dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['gen_WazaDesc m_name'][optional_parameters[i]] + '&';
                      }
                      dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
                      if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
                      query = new google.visualization.Query(dataSourceUrl);
                      query.send(function (QueryResponse) {
                        let gen_WazaDescm_name = QueryResponse.getDataTable();
                        if (gen_WazaDescm_name.getNumberOfRows() === 1 && gen_WazaDescm_name.getNumberOfColumns() === 1) {
                          a.textContent = gen_WazaDescm_name.getValue(0, 0);
                        }
                      });
                    } else if (label === 'm_type1' || label === 'm_type2') {
                      let a = document.createElement('a');
                      td.appendChild(a);
                      let tempParams = (new URL(document.location)).searchParams;;
                      tempParams.set('query', 'gen_PokeWazaTypeDesc');
                      tempParams.set('ID', gen_PiiDesc.getValue(j, i));
                      tempParams.delete('m_Monsno');
                      tempParams.delete('m_Formno');
                      a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + tempParams.toString());
                      a.textContent = gen_PiiDesc.getValue(j, i);

                      queryString = encodeURIComponent('select ' + ['F', 'G', 'H', 'I', 'J', 'K', 'L', 'M'][languages.indexOf(language)] + ' where A = ' + gen_PiiDesc.getValue(j, i));
                      dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
                      optional_parameters = ['gid'];
                      for (let i = 0; i < optional_parameters.length; i++) {
                        dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets['PokeWazaTypeDesc.msbt'][optional_parameters[i]] + '&';
                      }
                      dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
                      if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
                      query = new google.visualization.Query(dataSourceUrl);
                      query.send(function (QueryResponse) {
                        let PokeWazaTypeDescmsbt = QueryResponse.getDataTable();
                        if (PokeWazaTypeDescmsbt.getNumberOfRows() === 1 && PokeWazaTypeDescmsbt.getNumberOfColumns() === 1) {
                          a.textContent = PokeWazaTypeDescmsbt.getValue(0, 0);
                        }
                      });
                    } else {
                      td.textContent = gen_PiiDesc.getValue(j, i);
                    }
                    if (label === 'm_maxHP' || label === 'm_ap' || label === 'm_dp' || label === 'm_spd') {
                      td.style.backgroundColor = 'gray';
                      td.parentElement.querySelector('td').style.backgroundColor = 'gray';
                    }
                  }
                }
              });

              let div;
              div = document.createElement('div');
              divs[3].appendChild(div);
              div.textContent = 'Learnset';
              queryString = encodeURIComponent('where B = ' + m_Monsno + ' and C = ' + m_Formno);
              dataSourceUrl = Untitled_spreadsheet.URL + '/gviz/tq?';
              optional_parameters = ['gid'];
              for (let i = 0; i < optional_parameters.length; i++) {
                dataSourceUrl = dataSourceUrl + optional_parameters[i] + '=' + Untitled_spreadsheet.sheets.gen_WazaGetDesc[optional_parameters[i]] + '&';
              }
              dataSourceUrl = dataSourceUrl + 'tq' + '=' + queryString + '&';
              if (dataSourceUrl[dataSourceUrl.length - 1] === '&') dataSourceUrl = dataSourceUrl.slice(0, dataSourceUrl.length - 1);
              query = new google.visualization.Query(dataSourceUrl);
              query.send(function (QueryResponse) {
                let gen_WazaGetDesc = QueryResponse.getDataTable();
                let learnset = [];
                if (gen_WazaGetDesc.getNumberOfRows() === 1) {
                  for (let i = 0; i < gen_WazaGetDesc.getNumberOfColumns(); i++) {
                    if (gen_WazaGetDesc.getColumnLabel(i).startsWith('m_getLevel')) {
                      if (gen_WazaGetDesc.getValue(0, i) > 0) {
                        learnset.push([Number(gen_WazaGetDesc.getColumnLabel(i).split('[')[1].split(']')[0]), '', '', '', gen_WazaGetDesc.getValue(0, i)]);
                      }
                    }
                  }
                }
                let learnsetHeaders = ['ID', 'm_star', 'm_type', 'm_name', 'm_getLevel'];
                async function a() {
                  while (gen_WazaDesc === undefined || PokeWazaTypeDescmsbt === undefined || gen_WazaDescm_name === undefined) {
                    await resolveAfter(1000);
                  }
                  for (let i = 0; i < learnset.length; i++) {
                    for (let j = 0; j < gen_WazaDesc.getNumberOfRows(); j++) {
                      if (gen_WazaDesc.getValue(j, 0) === learnset[i][0]) {
                        for (let k = 0; k < gen_WazaDesc.getNumberOfColumns(); k++) {
                          if (gen_WazaDesc.getColumnLabel(k) === learnsetHeaders[1]) {
                            learnset[i][1] = gen_WazaDesc.getValue(j, k);
                          }
                          if (gen_WazaDesc.getColumnLabel(k) === learnsetHeaders[2]) {
                            learnset[i][2] = gen_WazaDesc.getValue(j, k);
                          }
                        }
                        break;
                      }
                    }
                    for (let j = 0; j < PokeWazaTypeDescmsbt.getNumberOfRows(); j++) {
                      if (PokeWazaTypeDescmsbt.getValue(j, 0) === learnset[i][2]) {
                        learnset[i][2] = PokeWazaTypeDescmsbt.getValue(j, 1);
                        break;
                      }
                    }
                    for (let j = 0; j < gen_WazaDescm_name.getNumberOfRows(); j++) {
                      if (gen_WazaDescm_name.getValue(j, 0) === learnset[i][0]) {
                        learnset[i][3] = gen_WazaDescm_name.getValue(j, 1);
                        break;
                      }
                    }
                  }

                  learnset.sort(function (a, b) {
                    return a[4] - b[4];
                  });

                  learnset.sort(function (a, b) {
                    return b[1] - a[1];
                  });

                  let table = document.createElement('table');
                  divs[3].appendChild(table);
                  let thead = document.createElement('thead');
                  table.appendChild(thead);
                  let tr = document.createElement('tr');
                  thead.appendChild(tr);
                  for (let i = 0; i < learnsetHeaders.length; i++) {
                    let th = document.createElement('th');
                    tr.appendChild(th);
                    th.textContent = learnsetHeaders[i];
                  }
                  let tbody = document.createElement('tbody');
                  table.appendChild(tbody);
                  if (learnset.length === 0) {
                    let tr = document.createElement('tr');
                    tbody.appendChild(tr);
                    let td = document.createElement('td');
                    tr.appendChild(td);
                    td.setAttribute('colspan', 5);
                    td.textContent = 'No information available.';
                  }
                  for (let i = 0; i < learnset.length; i++) {
                    let tr = document.createElement('tr');
                    tbody.appendChild(tr);
                    for (let j = 0; j < learnset[i].length; j++) {
                      let td = document.createElement('td');
                      tr.appendChild(td);
                      if (learnsetHeaders[j] === 'm_name') {
                        let a = document.createElement('a');
                        td.appendChild(a);
                        let tempParams = (new URL(document.location)).searchParams;;
                        tempParams.set('query', 'gen_WazaDesc');
                        tempParams.set('ID', learnset[i][0]);
                        tempParams.delete('m_Monsno');
                        tempParams.delete('m_Formno');
                        a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + tempParams.toString());
                        a.textContent = learnset[i][j];
                      } else {
                        td.textContent = learnset[i][j];
                      }
                    }
                  }
                }
                a();
              });
            }
          }
        },

      }

      if (params.has('query')) {
        let q = params.get('query');
        let cb;
        if (q === 'gen_PiiDesc') {
          title.textContent = 'gen_WazaDesc';
          if (params.has('m_Monsno')) {
            let m_Monsno = params.get('m_Monsno');
            if (params.has('m_Formno')) {
              let m_Formno = params.get('m_Formno');
              cb = function () {
                callback.gen_PiiDesc(m_Monsno, m_Formno);
              };
            } else {
              cb = function () {
                callback.gen_PiiDesc(m_Monsno);
              };
            }
          } else {
            cb = callback.gen_PiiDesc;
          }
        } else if (q === 'gen_WazaDesc') {
          title.textContent = 'gen_WazaDesc';
          if (params.has('ID')) {
            let ID = params.get('ID');
            cb = function () {
              callback.gen_WazaDesc(ID);
            };
          } else {
            cb = callback.gen_WazaDesc;
          }
        }
        google.charts.setOnLoadCallback(cb);
      } else {
        let div = document.createElement('div');
        body.appendChild(div);
        let a;
        a = document.createElement('a');
        div.appendChild(a);
        a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + 'query' + '=' + 'gen_PiiDesc');
        a.textContent = 'gen_PiiDesc';
        div.append(' ');
        a = document.createElement('a');
        div.appendChild(a);
        a.setAttribute('href', (new URL(document.location)).toString().split('?')[0] + '?' + 'query' + '=' + 'gen_WazaDesc');
        a.textContent = 'gen_WazaDesc';
        div.append(' ');
        a = document.createElement('a');
        div.appendChild(a);
        a.setAttribute('href', 'https://peterd1524.github.io/test');
        a.textContent = 'old';
      }

      function languagechangeHandler(event) {
        // document.cookie = "language=" + whatLanguage;
        if (storageAvailable('localStorage')) {
          localStorage.setItem('language', event.target.value);
        }
        params.set('language', event.target.value);
        select.value = language;
        window.location = (new URL(document.location)).toString().split('?')[0] + '?' + params.toString();
      }
    });
  </script>
  <style>
    body {
      background-color: mintcream;
    }

    body * {
      font-family: 'Roboto Mono', 'Roboto', 'Noto Sans TC', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
      font-size: xx-large;
    }

    body>* {
      margin: 1em;
    }

    table {
      border-collapse: collapse;
    }

    th,
    td {
      border: 1px solid black;
    }

    /* Rules for sizing the icon. */
    .material-icons.md-18 {
      font-size: 18px;
    }

    .material-icons.md-24 {
      font-size: 24px;
    }

    .material-icons.md-36 {
      font-size: 36px;
    }

    .material-icons.md-48 {
      font-size: 48px;
    }

    /* Rules for using icons as black on a light background. */
    .material-icons.md-dark {
      color: rgba(0, 0, 0, 0.54);
    }

    .material-icons.md-dark.md-inactive {
      color: rgba(0, 0, 0, 0.26);
    }
  </style>
</head>

<body>
</body>

</html>